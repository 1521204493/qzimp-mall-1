import{_ as M,r as p,c as D,a as C,b as t,w as R,d as o,F as G,E as O,e as H,o as u,f as J,g as I,i as V,j as Q,k as W,l as X}from"./index-abac234f.js";import{a as h,E as Y,b as E,c as s,d as Z,e as $,f as ee,g as te}from"./index-5d52cb72.js";import{E as le,a as oe,b as ae}from"./el-progress-ca4d4ee9.js";import{E as ne}from"./el-date-picker-c408b619.js";let x;const g=()=>{x=Y.service({lock:!0,text:"加载中...",spinner:"wave"})},b=()=>{x&&x.close()},se=async l=>{g();try{return await h.request({url:"/mall/cms-subject-comment/one/"+l,method:"get"})}catch(e){throw e}finally{b()}},ie=async l=>{g();try{return await h.request({url:"/mall/cms-subject-comment/del/"+l,method:"get"})}catch(e){throw e}finally{b()}},re=async l=>{g();try{return await h.request({url:"/mall/cms-subject-comment/edit",method:"post",data:l})}catch(e){throw e}finally{b()}},ce=async l=>{g();try{return await h.request({url:"/mall/cms-subject-comment/add",method:"post",data:l})}catch(e){throw e}finally{b()}},de=async l=>{g();try{return await h.request({url:"/mall/cms-subject-comment/page",method:"post",data:l})}catch(e){throw e}finally{b()}},k={One:se,Del:ie,Edit:re,Add:ce,Page:de};const ue={data(){return{json:{current:1,size:99},searchText:"",currentPage:1,pageSize:6,total:0,tableData:[],editDialogVisible:!1,editItem:{},selectedRow:null}},computed:{paginatedData(){const l=(this.currentPage-1)*this.pageSize,e=l+this.pageSize;return this.filteredtableData.slice(l,e)},filteredtableData(){return this.searchText&&this.tableData&&this.tableData.length>0?this.tableData.filter(l=>String(l.name).includes(String(this.searchText))):this.tableData||[]}},methods:{openEditDialog(l){this.editItem={...l},this.editDialogVisible=!0},handlePageChange(l){this.currentPage=l},saveEdit(){console.log(this.editItem),E.confirm("确定修改吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{const l=this.tableData.findIndex(e=>e.id===this.editItem.id);l!==-1?this.tableData.splice(l,1,this.editItem):this.tableData.push(this.editItem),this.editDialogVisible=!1,s.success("修改成功！"),this.editItem={}}).catch(()=>{s.info("修改取消！")})},fetchData(){k.Page(this.json).then(l=>{this.tableData=l.data.data.page.records||l.data.records,console.log(this.tableData),s.success("刷新成功！")}).catch(l=>{s.error("刷新失败，请检查网络！"),console.error("Error fetching data:",l)})},Insert(l){k.Add(l).then(e=>{delete l.isNew,s.success("插入数据成功！")}).catch(e=>{s.error("插入数据失败！"),console.error("保存修改失败:",e)})},Alter(l){k.Edit(l).then(e=>{console.log("修改保存成功:",e.data),s.success("修改数据成功！")}).catch(e=>{s.error("修改数据失败！"),console.error("保存修改失败:",e)})},Del(l){E.confirm("确定要删除吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{k.Del(l.id).then(e=>{const _=this.tableData.findIndex(w=>w.id===l.id);_!==-1&&this.tableData.splice(_,1),console.log("删除成功:",e.data),s.success("删除成功！")}).catch(e=>{s.error(response.msg),console.error("删除失败:",e)})}).catch(()=>{})},delND(l){E.confirm("确定要删除吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{const e=this.tableData.findIndex(_=>_.id===l.id);e!==-1&&this.tableData.splice(e,1),s.success("删除成功！")}).catch(()=>{s.error("删除失败！"),console.log("取消删除 API",l)})},addAPI(){s.success("添加数据ing");const l={icon:"",id:0,name:"",showStatus:0,sort:0,subjectCount:0,isNew:!0};this.tableData.push(l);const e=Math.ceil(this.tableData.length/this.pageSize);this.handlePageChange(e)}},created(){this.fetchData()}},me=["src"],pe={key:0},_e={key:1},fe={slot:"footer"},he={class:"button"};function ge(l,e,_,w,n,i){const f=O,d=te,P=p("Position"),c=Q,r=H,S=p("EditPen"),v=p("Delete"),T=Z,j=$,m=W,B=ne,U=p("Upload"),A=le,N=oe,z=ae,q=X,F=ee,K=p("DocumentAdd"),L=p("Sort");return u(),D(G,null,[C("div",null,[t(f,{modelValue:n.searchText,"onUpdate:modelValue":e[0]||(e[0]=a=>n.searchText=a),placeholder:"请输入搜索关键字",clearable:"",onClear:l.clearSearch,onKeyup:R(l.performSearch,["enter"]),style:{"margin-bottom":"20px"}},null,8,["modelValue","onClear","onKeyup"]),t(T,{data:i.paginatedData,"header-cell-style":{background:"#eef1f6",color:"#606266"},borde:""},{default:o(()=>[t(d,{prop:"content",label:"内容"}),t(d,{prop:"createTime",label:"创建时间"}),t(d,{prop:"id",label:"id"}),t(d,{prop:"memberIcon",label:"成员图标"},{default:o(({row:a})=>[isNaN(Number(a.memberIcon,9))?(u(),D("img",{key:0,src:a.memberIcon,alt:"图标",width:"30",height:"30"},null,8,me)):J("",!0)]),_:1}),t(d,{prop:"memberNickName",label:"成员昵称"}),t(d,{prop:"subjectId",label:"主题id"}),t(d,{prop:"showStatus",label:"显示状态"},{default:o(({row:a})=>[a.showStatus==0?(u(),D("span",pe,"隐藏")):(u(),D("span",_e,"显示"))]),_:1}),t(d,{label:"操作"},{default:o(({row:a})=>[a.isNew?(u(),I(r,{key:0,class:"custom-button",type:"success",circle:"",onClick:y=>i.Insert(a)},{default:o(()=>[t(c,null,{default:o(()=>[t(P)]),_:1})]),_:2},1032,["onClick"])):(u(),I(r,{key:1,class:"custom-button",type:"warning",circle:"",onClick:y=>i.Alter(a)},{default:o(()=>[t(c,null,{default:o(()=>[t(P)]),_:1})]),_:2},1032,["onClick"])),t(r,{type:"primary",circle:"",onClick:y=>i.openEditDialog(a)},{default:o(()=>[t(c,null,{default:o(()=>[t(S)]),_:1})]),_:2},1032,["onClick"]),a.isNew?(u(),I(r,{key:2,type:"danger",circle:"",onClick:y=>i.delND(a)},{default:o(()=>[t(c,null,{default:o(()=>[t(v)]),_:1})]),_:2},1032,["onClick"])):(u(),I(r,{key:3,type:"danger",circle:"",onClick:y=>i.Del(a)},{default:o(()=>[t(c,null,{default:o(()=>[t(v)]),_:1})]),_:2},1032,["onClick"]))]),_:1})]),_:1},8,["data"]),t(j,{"current-page":n.currentPage,"page-size":n.pageSize,total:i.filteredtableData.length,onCurrentChange:i.handlePageChange},null,8,["current-page","page-size","total","onCurrentChange"]),t(F,{class:"form",modelValue:n.editDialogVisible,"onUpdate:modelValue":e[9]||(e[9]=a=>n.editDialogVisible=a),onClose:e[10]||(e[10]=a=>n.editDialogVisible=!1)},{default:o(()=>[t(q,null,{default:o(()=>[t(m,{label:"内容"},{default:o(()=>[t(f,{modelValue:n.editItem.content,"onUpdate:modelValue":e[1]||(e[1]=a=>n.editItem.content=a)},null,8,["modelValue"])]),_:1}),t(m,{label:"创建时间"},{default:o(()=>[t(B,{modelValue:n.editItem.createTime,"onUpdate:modelValue":e[2]||(e[2]=a=>n.editItem.createTime=a),type:"datetime",placeholder:"选择日期时间"},null,8,["modelValue"])]),_:1}),t(m,{label:"id"},{default:o(()=>[t(f,{modelValue:n.editItem.id,"onUpdate:modelValue":e[3]||(e[3]=a=>n.editItem.id=a),disabled:""},null,8,["modelValue"])]),_:1}),t(m,{label:"成员图标"},{default:o(()=>[t(A,{action:"/upload",modelValue:n.editItem.memberIcon,"onUpdate:modelValue":e[4]||(e[4]=a=>n.editItem.memberIcon=a),"list-type":"picture","auto-upload":!1},{default:o(()=>[t(r,{slot:"trigger",size:"small",circle:"",type:"primary"},{default:o(()=>[t(c,null,{default:o(()=>[t(c,null,{default:o(()=>[t(U)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(m,{label:"成员昵称"},{default:o(()=>[t(f,{modelValue:n.editItem.memberName,"onUpdate:modelValue":e[5]||(e[5]=a=>n.editItem.memberName=a)},null,8,["modelValue"])]),_:1}),t(m,{label:"主题id"},{default:o(()=>[t(f,{modelValue:n.editItem.subjectId,"onUpdate:modelValue":e[6]||(e[6]=a=>n.editItem.subjectId=a)},null,8,["modelValue"])]),_:1}),t(m,{label:"显示状态"},{default:o(()=>[t(z,{modelValue:n.editItem.showStatus,"onUpdate:modelValue":e[7]||(e[7]=a=>n.editItem.showStatus=a)},{default:o(()=>[t(N,{label:1},{default:o(()=>[V("显示")]),_:1}),t(N,{label:0},{default:o(()=>[V("隐藏")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),C("div",fe,[t(r,{onClick:e[8]||(e[8]=a=>n.editDialogVisible=!1)},{default:o(()=>[V("取消")]),_:1}),t(r,{type:"primary",onClick:i.saveEdit},{default:o(()=>[V("保存")]),_:1},8,["onClick"])])]),_:1},8,["modelValue"])]),C("div",he,[t(r,{type:"primary",circle:"",onClick:i.addAPI,style:{"margin-top":"10px"}},{default:o(()=>[t(c,null,{default:o(()=>[t(K)]),_:1})]),_:1},8,["onClick"]),t(r,{type:"danger",circle:"",onClick:e[11]||(e[11]=a=>l.Sort()),style:{"margin-top":"10px"}},{default:o(()=>[t(c,null,{default:o(()=>[t(L)]),_:1})]),_:1})])],64)}const Ve=M(ue,[["render",ge]]);export{Ve as default};
